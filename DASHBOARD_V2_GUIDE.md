# BB Bounce ML - Realtime Detector V2 ä½¿ç”¨æŒ‡å—

## åŠŸèƒ½æ¦‚è¦½

æ–°çš„å„€è¡¨æ¿ V2 åŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½:

### 1. å¹£ç¨®é¸æ“‡é¢æ¿ (å·¦å´)
- é¡¯ç¤ºæ‰€æœ‰ 22 å€‹ç›£æŽ§å¹£ç¨®
- å‹¾é¸å¹£ç¨®é€²è¡Œå¤šé¸
- å¯¦æ™‚é¡¯ç¤ºå·²é¸ä¸­çš„å¹£ç¨®æ•¸é‡
- äº’å‹•å¼åˆ—è¡¨ï¼Œè¦–è¦ºåé¥‹æ¸…æ™°

### 2. æ™‚é–“æ¡†æž¶é¸æ“‡
- æ”¯æ´å…©ç¨®æ™‚é–“æ¡†æž¶: **15åˆ†é˜** å’Œ **1å°æ™‚**
- ä¸€éµåˆ‡æ›ï¼Œç³»çµ±è‡ªå‹•åˆ‡æ›å°æ‡‰çš„æ¨¡åž‹
- ä¸‹æ‹‰é¸å–®ä½ç½®: æŽ§åˆ¶å€åŸŸé ‚éƒ¨

### 3. æª¢æ¸¬æ¨¡å¼åˆ‡æ›
æä¾› 3 ç¨®æª¢æ¸¬æ¨¡å¼:

| æ¨¡å¼ | èªªæ˜Ž | ä½¿ç”¨å ´æ™¯ |
|------|------|--------|
| **æ‰€æœ‰ä¿¡è™Ÿ** | é¡¯ç¤ºæ‰€æœ‰æª¢æ¸¬åˆ°çš„ä¿¡è™Ÿ | å®Œæ•´ç›£æŽ§ï¼Œç™¼ç¾æ‰€æœ‰æ©Ÿæœƒ |
| **åƒ… BB é€šé“æŽ¥è§¸** | åªé¡¯ç¤ºæŽ¥è§¸ BB ä¸Šä¸‹è»Œçš„ä¿¡è™Ÿ | èšç„¦é«˜é¢¨éšªå€é–“ |
| **é«˜ä¿¡å¿ƒåº¦ (>75%)** | åªé¡¯ç¤ºæœ‰æ•ˆæ€§æ¦‚çŽ‡ > 75% çš„ä¿¡è™Ÿ | éŽæ¿¾ä½Žå“è³ªä¿¡è™Ÿ |

### 4. å¯¦æ™‚ä¿¡è™Ÿé¢æ¿ (ä¸­å¤®)

æ¯å€‹ä¿¡è™Ÿå¡ç‰‡é¡¯ç¤º:
- **å¹£ç¨®åç¨±** - å¦‚ BTCUSDT
- **æ™‚é–“æˆ³** - ä¿¡è™Ÿç”¢ç”Ÿæ™‚é–“
- **äº¤æ˜“æ–¹å‘** - å¤šé ­ (â†‘) æˆ–ç©ºé ­ (â†“)
- **ä½ç½®æ¨™ç±¤** - æŽ¥è§¸äº†ä¸Šè»Œã€ä¸­è»Œã€é‚„æ˜¯ä¸‹è»Œ
- **æœ‰æ•ˆæ€§æ¦‚çŽ‡** - 0-100% çš„æµ®é»žæ•¸
- **å“è³ªå¾½ç« ** - EXCELLENT / GOOD / MODERATE
- **RSI & ADX** - æŠ€è¡“æŒ‡æ¨™æ•¸å€¼

### 5. æ¨¡åž‹èª¿è©¦ä¿¡æ¯é¢æ¿ (å³å´)

å¯¦æ™‚é¡¯ç¤º:
- ç³»çµ±åˆå§‹åŒ–ç‹€æ…‹
- å·²åŠ è¼‰çš„å¹£ç¨®æ•¸é‡
- æœ€æ–°è§¸ç™¼çš„ä¿¡è™Ÿæ—¥èªŒ
- èª¿ç”¨éŽçš„æ¨¡åž‹åç¨±
- ç³»çµ±éŒ¯èª¤å’Œè­¦å‘Š

**èª¿è©¦ä¿¡æ¯æ—¥èªŒç¤ºä¾‹:**
```
[14:05:23] âœ“ WebSocket é€£æŽ¥æˆåŠŸ
[14:05:24] ðŸ“Š å·²åŠ è¼‰ 22 å€‹å¹£ç¨®
[14:05:24] æ¨¡åž‹é…ç½®:
[14:05:24]   â€¢ æ³¢å‹•å¤§å°åˆ†é¡žå™¨
[14:05:24]   â€¢ BB é€šé“ä¸Šä¸‹è»Œåˆ†é¡žå™¨
[14:05:24]   â€¢ æœ‰æ•ˆæ€§é©—è­‰æ¨¡åž‹
[14:05:25] ðŸ“ˆ æ–°ä¿¡è™Ÿ: BTCUSDT LONG @ 92%
[14:05:26] âœ“ å¹£ç¨®åˆ‡æ›: ETHUSDT (é¸æ“‡)
[14:05:27] âš¡ å¼·åˆ¶åˆ·æ–°æ‰€æœ‰å¹£ç¨®
```

## æ“ä½œæµç¨‹

### å¿«é€Ÿé–‹å§‹

1. **æ‰“é–‹å„€è¡¨æ¿**
   - è¨ªå• `http://localhost:5000/detector`

2. **é¸æ“‡ç›£æŽ§å¹£ç¨®**
   - é»žæ“Šå·¦å´åˆ—è¡¨ä¸­çš„å¹£ç¨®é€²è¡Œå‹¾é¸
   - æˆ–ä½¿ç”¨ã€Œå…¨é¸ã€å¿«æ·æ–¹å¼ï¼ˆå¦‚æœ‰ï¼‰

3. **è¨­ç½®æ™‚é–“æ¡†æž¶**
   - åœ¨æŽ§åˆ¶å€åŸŸé¸æ“‡ 15m æˆ– 1h
   - ç³»çµ±è‡ªå‹•åŠ è¼‰å°æ‡‰æ¨¡åž‹

4. **åˆ‡æ›æª¢æ¸¬æ¨¡å¼**
   - æ ¹æ“šéœ€è¦é¸æ“‡æª¢æ¸¬æ¨¡å¼
   - å¯¦æ™‚éŽæ¿¾ä¿¡è™Ÿ

5. **ç›£æŽ§å¯¦æ™‚ä¿¡è™Ÿ**
   - ä¿¡è™Ÿè‡ªå‹•æŽ¨é€åˆ°ä¸­å¤®é¢æ¿
   - é»žæ“Šã€Œæš«åœã€å¯åœæ­¢æ›´æ–°
   - é»žæ“Šã€Œç«‹å³æŽƒæã€å¼·åˆ¶é‡æ–°æŽƒæ

## æ¨¡åž‹è©³è§£

### Layer 1: æ³¢å‹•å¤§å°åˆ†é¡žå™¨ (Volatility Classifier)
**ç›®çš„**: åˆ¤æ–·ç•¶å‰è Ÿç‡­çš„æ³¢å‹•å¤§å°

**è¼¸å…¥ç‰¹å¾µ**:
- ATR (å¹³å‡çœŸå¯¦æ³¢å¹…)
- æœ€è¿‘ N æ ¹è Ÿç‡­çš„æ³¢å¹…
- æˆäº¤é‡è®ŠåŒ–

**è¼¸å‡º**: å¤§æ³¢å‹• / ä¸­ç­‰æ³¢å‹• / å°æ³¢å‹•

### Layer 1: BB é€šé“ä¸Šä¸‹è»Œåˆ†é¡žå™¨ (BB Band Classifier)
**ç›®çš„**: åˆ¤æ–·åƒ¹æ ¼æ˜¯å¦æŽ¥è§¸æˆ–æŽ¥è¿‘ BB ä¸Šä¸‹è»Œ

**è¼¸å…¥ç‰¹å¾µ**:
- è·é›¢ä¸Šè»Œçš„ç™¾åˆ†æ¯”
- è·é›¢ä¸‹è»Œçš„ç™¾åˆ†æ¯”
- BB é€šé“å¯¬åº¦
- RSI

**è¼¸å‡º**: æŽ¥è§¸ä¸Šè»Œ / ä¸­é–“å€ / æŽ¥è§¸ä¸‹è»Œ + ä¿¡å¿ƒåº¦

### Layer 2: æœ‰æ•ˆæ€§é©—è­‰æ¨¡åž‹ (Validity Validator)
**ç›®çš„**: é©—è­‰ Layer 1 çš„ä¿¡è™Ÿæ˜¯å¦çœŸæ­£æœ‰æ•ˆ

**è¼¸å…¥ç‰¹å¾µ**:
- Layer 1 é æ¸¬çµæžœ
- æœªä¾† N æ ¹è Ÿç‡­çš„èµ°å‹¢
- ADX å¼·åº¦æŒ‡æ¨™
- æˆäº¤é‡ç¢ºèª

**è¼¸å‡º**: æœ‰æ•ˆæ€§æ¦‚çŽ‡ (0-100%)

## èª¿è©¦ä¿¡æ¯çš„å«ç¾©

### æ—¥èªŒå‰ç¶´

| å‰ç¶´ | å«ç¾© | é¡è‰² |
|------|------|------|
| `[HH:MM:SS]` | æ™‚é–“æˆ³ | è—è‰² |
| `âœ“` | æˆåŠŸæ“ä½œ | ç¶ è‰² |
| `âœ—` | éŒ¯èª¤æˆ–å¤±æ•— | ç´…è‰² |
| `âš¡` | å¼·åˆ¶æ“ä½œ | ç¶ è‰² |
| `ðŸ”` | æª¢æ¸¬å‹•ä½œ | ç¶ è‰² |
| `ðŸ“Š` | æ•¸æ“šæ“ä½œ | ç¶ è‰² |
| `â¸` | æš«åœ/æ¢å¾© | ç¶ è‰² |
| `ðŸ›` | èª¿è©¦ä¿¡æ¯ | ç´«è‰² |

### å¸¸è¦‹èª¿è©¦æ¶ˆæ¯

```bash
# WebSocket é€£æŽ¥
âœ“ WebSocket é€£æŽ¥æˆåŠŸ
âœ— WebSocket é€£æŽ¥å·²æ–·é–‹

# ç³»çµ±åˆå§‹åŒ–
ðŸš€ æ‡‰ç”¨å•Ÿå‹•æˆåŠŸ
ðŸ“Š å·²åŠ è¼‰ 22 å€‹å¹£ç¨®

# æ¨¡åž‹æ“ä½œ
ðŸ“ˆ æ–°ä¿¡è™Ÿ: BTCUSDT LONG @ 92%
ðŸ” æª¢æ¸¬æ¨¡å¼: all
â¸ å¯¦æ™‚æ›´æ–°å·²æš«åœ
â–¶ å¯¦æ™‚æ›´æ–°å·²æ¢å¾©

# ç”¨æˆ¶æ“ä½œ
âœ“ å¹£ç¨®åˆ‡æ›: ETHUSDT (é¸æ“‡/å–æ¶ˆ)
â± æ™‚é–“æ¡†æž¶è®Šæ›´: 1h
ðŸŽ¯ æª¢æ¸¬æ¨¡å¼: high-confidence
âš¡ å¼·åˆ¶åˆ·æ–°æ‰€æœ‰å¹£ç¨®

# é¸é …ç‹€æ…‹
ðŸ‘ åªé¡¯ç¤ºæ´»èºå¹£ç¨®: é–‹/é—œ
ðŸ› èª¿è©¦ä¿¡æ¯: é¡¯ç¤º/éš±è—
```

## å‰ç«¯æž¶æ§‹

### é—œéµçµ„ä»¶

1. **Symbol List** (å¹£ç¨®åˆ—è¡¨)
   - Vue-like éŸ¿æ‡‰å¼æ›´æ–°
   - æ”¯æ´å¤šé¸
   - å¯¦æ™‚ç‹€æ…‹åŒæ­¥

2. **Signal Grid** (ä¿¡è™Ÿç¶²æ ¼)
   - æœ€å¤šé¡¯ç¤º 20 å€‹æœ€æ–°ä¿¡è™Ÿ
   - ä¾æ™‚é–“æˆ³æŽ’åº
   - æ™ºèƒ½éŽæ¿¾

3. **Debug Panel** (èª¿è©¦é¢æ¿)
   - å¯¦æ™‚æ—¥èªŒæµ
   - æœ€å¤šä¿å­˜ 50 è¡Œ
   - å¸¶æ™‚é–“æˆ³å’Œé¡žåž‹åˆ†é¡ž

### WebSocket äº‹ä»¶æµ

```
å‰ç«¯                           å¾Œç«¯
  |
  |---> request_symbol_list ----->
  |                               |
  |<------ symbol_list_response --|
  |
  |---> select_symbol -------->
  |                           |
  |<---- selection_updated ---|
  |
  |<----- realtime_signal ------| (æŽ¨é€)
  |<----- symbols_state_update -| (æŽ¨é€)
```

## å¾Œç«¯æž¶æ§‹

### RealtimeBBDetectorV2 é¡ž

**ä¸»è¦æ–¹æ³•**:

```python
# åˆå§‹åŒ–
detector = RealtimeBBDetectorV2(
    symbols=[...],
    model_dir="models",
    device="cpu"
)

# æ·»åŠ æ–°çš„è Ÿç‡­
detector.add_candle(symbol, candle_data)

# æŽƒææ‰€æœ‰å¹£ç¨®
signals = detector.scan_all(timeframe="15m")

# ç²å–å¹£ç¨®ç‹€æ…‹
state = detector.get_symbol_state("BTCUSDT")
```

### å¯¦æ™‚æŽƒæ Loop

```python
def realtime_scan_loop():
    while scan_active:
        # 1. å–å¾—æœ€æ–° K ç·š
        latest_candles = fetch_latest_candles(symbols, timeframe)
        
        # 2. åŠ å…¥æª¢æ¸¬å™¨
        for symbol, candles in latest_candles.items():
            for candle in candles:
                detector.add_candle(symbol, candle)
        
        # 3. åŸ·è¡ŒäºŒå±¤æŽƒæ
        signals = detector.scan_all(timeframe)
        
        # 4. æŽ¨é€ä¿¡è™Ÿ
        for signal in signals:
            socketio.emit("realtime_signal", signal)
        
        time.sleep(5.0)  # æ¯ 5 ç§’åŸ·è¡Œä¸€æ¬¡
```

## æ€§èƒ½æŒ‡æ¨™

### é æœŸæ€§èƒ½

| æŒ‡æ¨™ | å€¼ |
|------|-----|
| æŽƒæé–“éš” | 5 ç§’ |
| å–®æ¬¡æŽƒææ™‚é–“ | < 1 ç§’ (22 å¹£ç¨®) |
| ä¿¡è™ŸæŽ¨é€å»¶é² | < 100ms |
| å‰ç«¯ UI æ›´æ–°å»¶é² | < 50ms |
| èª¿è©¦ä¿¡æ¯è™•ç† | < 10ms |

### è³‡æºä½”ç”¨

| è³‡æº | ä¼°è¨ˆå€¼ |
|------|--------|
| CPU ä½¿ç”¨çŽ‡ | 15-30% |
| å…§å­˜ä½¿ç”¨ | 300-500MB |
| ç¶²çµ¡å¸¶å¯¬ | 10-50KB/s |

## å¸¸è¦‹å•é¡Œ

### Q: ç‚ºä»€éº¼æ²’æœ‰çœ‹åˆ°ä»»ä½•ä¿¡è™Ÿ?
A: 
1. ç¢ºä¿è‡³å°‘é¸æ“‡äº†ä¸€å€‹å¹£ç¨®
2. æª¢æŸ¥æª¢æ¸¬æ¨¡å¼è¨­ç½®
3. æª¢æŸ¥èª¿è©¦é¢æ¿æ˜¯å¦æœ‰éŒ¯èª¤ä¿¡æ¯
4. å˜—è©¦é»žæ“Šã€Œç«‹å³æŽƒæã€å¼·åˆ¶åˆ·æ–°

### Q: èª¿è©¦ä¿¡æ¯é¢æ¿æ˜¯ç©ºçš„?
A:
1. ç¢ºä¿å‹¾é¸äº†ã€Œé¡¯ç¤ºèª¿è©¦ä¿¡æ¯ã€
2. åˆ·æ–°é é¢é‡æ–°é€£æŽ¥
3. æª¢æŸ¥ç€è¦½å™¨æŽ§åˆ¶å°æ˜¯å¦æœ‰ WebSocket éŒ¯èª¤

### Q: å¦‚ä½•çŸ¥é“ç•¶å‰èª¿ç”¨äº†å“ªäº›æ¨¡åž‹?
A:
- æŸ¥çœ‹èª¿è©¦ä¿¡æ¯é¢æ¿çš„åˆå§‹åŒ–éƒ¨åˆ†
- æ ¹æ“šæ™‚é–“æ¡†æž¶(15m/1h)ï¼Œç³»çµ±æœƒè‡ªå‹•åŠ è¼‰å°æ‡‰çš„æ¨¡åž‹
- æ¯å€‹ä¿¡è™Ÿæ—é‚Šçš„ä¿¡æ¯éƒ½åæ˜ äº†æ¨¡åž‹çš„å·¥ä½œçµæžœ

### Q: æš«åœæŒ‰éˆ•çš„ä½œç”¨æ˜¯ä»€éº¼?
A:
- é»žæ“Šã€Œæš«åœã€æœƒåœæ­¢å¯¦æ™‚ä¿¡è™ŸæŽ¨é€
- èª¿è©¦ä¿¡æ¯å’Œ UI ä»ç„¶éŸ¿æ‡‰
- é©åˆåœ¨åˆ†æžæŸå€‹ä¿¡è™Ÿæ™‚æš«æ™‚åœæ­¢æ›´æ–°æµ

## ä¸‹ä¸€æ­¥æ”¹é€²

- [ ] æ”¯æ´æ›´å¤šæ™‚é–“æ¡†æž¶ (5m, 4h, 1d)
- [ ] æ·»åŠ ä¿¡è™Ÿæ­·å²è¨˜éŒ„è¡¨
- [ ] æ”¯æ´è‡ªå®šç¾©é€šçŸ¥ (è²éŸ³/éƒµä»¶)
- [ ] æ·»åŠ æ¨¡åž‹æ€§èƒ½çµ±è¨ˆé¢æ¿
- [ ] æ”¯æ´ä¿¡è™Ÿå›žæ¸¬åŠŸèƒ½
- [ ] æ·»åŠ é¢¨éšªç®¡ç†å·¥å…·

---

**ç‰ˆæœ¬**: V2.0  
**æœ€å¾Œæ›´æ–°**: 2026-01-03  
**ç¶­è­·è€…**: äº¤æ˜“ç®—æ³•åœ˜éšŠ
